#Means
test_Mean         <- read_excel(".\\tests\\testthat\\testdata_Mean.xlsx", sheet="testdata_Mean",         col_names=TRUE)
test_Mean_results <- read_excel(".\\tests\\testthat\\testdata_Mean.xlsx", sheet="testdata_Mean_results", col_names=TRUE)
test_Mean_Grp <- group_by(test_Mean,area)
# DSRs, ISRs and SMRs
test_multiarea   <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multiarea", col_names=TRUE) %>%
group_by(area)
test_DSR_1976    <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_1976",   col_names=TRUE)
test_err1        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err1",   col_names=TRUE)
test_err2        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err2",   col_names=TRUE) %>%
group_by(area)
test_err3        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err3",   col_names=TRUE)
test_DSR_results <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testresults_DSR", col_names=TRUE)
test_multigroup  <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multigroup", col_names=TRUE) %>%
group_by(area,year)
test_ISR_results <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testresults_ISR", col_names=TRUE)
test_ISR_refdata <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="refdata",         col_names=TRUE)
test_ISR_ownref  <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multiarea_ref", col_names=TRUE) %>%
group_by(area)
library(dplyr)
library(testthat)
library(devtools)
library(readxl)
# Byars Wilson
test_BW <- read_excel(".\\tests\\testthat\\testdata_Byars_Wilson.xlsx", sheet="testdata_B_W",   col_names=TRUE)
# Proportions
test_Prop   <- read_excel(".\\tests\\testthat\\testdata_Proportion.xlsx", sheet="testdata_Prop",   col_names=TRUE)
#Rates
test_Rate <- read_excel(".\\tests\\testthat\\testdata_Rate.xlsx", sheet="testdata_Rate", col_names=TRUE)
#Means
test_Mean         <- read_excel(".\\tests\\testthat\\testdata_Mean.xlsx", sheet="testdata_Mean",         col_names=TRUE)
test_Mean_results <- read_excel(".\\tests\\testthat\\testdata_Mean.xlsx", sheet="testdata_Mean_results", col_names=TRUE)
test_Mean_Grp <- group_by(test_Mean,area)
# DSRs, ISRs and SMRs
test_multiarea   <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multiarea", col_names=TRUE) %>%
group_by(area)
test_DSR_1976    <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_1976",   col_names=TRUE)
test_err1        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err1",   col_names=TRUE)
test_err2        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err2",   col_names=TRUE) %>%
group_by(area)
test_err3        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err3",   col_names=TRUE)
test_DSR_results <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testresults_DSR", col_names=TRUE)
test_multigroup  <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multigroup", col_names=TRUE) %>%
group_by(area,year)
test_ISR_results <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testresults_ISR", col_names=TRUE)
test_ISR_refdata <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="refdata",         col_names=TRUE)
test_ISR_ownref  <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multiarea_ref", col_names=TRUE) %>%
group_by(area)
# use this code to save loaded data to R\sysdata.rda file:
devtools::use_data(test_BW, test_Prop,
test_Rate,
test_Mean, test_Mean_Grp, test_Mean_results,
test_multiarea, test_multigroup, test_DSR_1976, test_err1, test_err2, test_err3, test_DSR_results,
test_ISR_refdata, test_ISR_results, test_ISR_ownref,
internal = TRUE, overwrite = TRUE)
devtools::document()
devtools::load_all()
devtools:check()
devtools::check()
library(PHEindicatormethods)
?phe_dsr
library(dplyr)
df <- data.frame(indicatorid = rep(c(1234, 5678, 91011, 121314), each = 19 * 2 * 5),
year = rep(2006:2010, each = 19 * 2),
sex = rep(rep(c("Male", "Female"), each = 19), 5),
ageband = rep(c(0,5,10,15,20,25,30,35,40,45,
50,55,60,65,70,75,80,85,90), times = 10),
obs = sample(200, 19 * 2 * 5 * 4, replace = TRUE),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE))
df %>%
group_by(indicatorid, year, sex) %>%
phe_dsr(obs, pop)
df %>%
group_by(indicatorid, year, sex) %>%
phe_dsr(obs, pop, type = "full")
?phe_proportion
df <- data.frame(area = c("Area1","Area2","Area3"),
numerator = c(65,82,100),
denominator = c(100,100,100))
phe_proportion(df, numerator, denominator)
phe_proportion(df, numerator, denominator, confidence=99.8)
phe_proportion(df, numerator, denominator, type="full")
?phe_rate
df <- data.frame(area = rep(c("Area1","Area2","Area3","Area4"), 2),
year = rep(2015:2016, each = 4),
obs = sample(100, 2 * 4, replace = TRUE),
pop = sample(100:200, 2 * 4, replace = TRUE))
phe_rate(df, obs, pop)
phe_rate(df, obs, pop, type="full", confidence=99.8, multiplier=100)
?phe_mean
library(dplyr)
df <- data.frame(values = c(30,40,50,60))
phe_mean(df, values)
df2 <- data.frame(area = rep(c("Area1", "Area2"),each=3),
values = c(20,30,40,200,300,400)) %>%
group_by(area)
phe_mean(df2,values)
phe_mean(df2,values,type="full", confidence=0.998)
?phe_isr
library(dplyr)
df <- data.frame(indicatorid = rep(c(1234, 5678, 91011, 121314), each = 19 * 2 * 5),
year = rep(2006:2010, each = 19 * 2),
sex = rep(rep(c("Male", "Female"), each = 19), 5),
ageband = rep(c(0,5,10,15,20,25,30,35,40,45,
50,55,60,65,70,75,80,85,90), times = 10),
obs = sample(200, 19 * 2 * 5 * 4, replace = TRUE),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE))
refdf <- data.frame(refcount = sample(200, 19, replace = TRUE),
refpop = sample(10000:20000, 19, replace = TRUE))
df %>%
group_by(indicatorid, year, sex) %>%
phe_isr(obs, pop, refdf$refcount, refdf$refpop)
df %>%
group_by(indicatorid, year, sex) %>%
phe_isr(obs, pop, refdf$refcount, refdf$refpop, type="full", confidence=99.8)
?phe_smr
library(dplyr)
df <- data.frame(indicatorid = rep(c(1234, 5678, 91011, 121314), each = 19 * 2 * 5),
year = rep(2006:2010, each = 19 * 2),
sex = rep(rep(c("Male", "Female"), each = 19), 5),
ageband = rep(c(0,5,10,15,20,25,30,35,40,45,
50,55,60,65,70,75,80,85,90), times = 10),
obs = sample(200, 19 * 2 * 5 * 4, replace = TRUE),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE))
refdf <- data.frame(refcount = sample(200, 19, replace = TRUE),
refpop = sample(10000:20000, 19, replace = TRUE))
df %>%
group_by(indicatorid, year, sex) %>%
phe_smr(obs, pop, refdf$refcount, refdf$refpop)
df %>%
group_by(indicatorid, year, sex) %>%
phe_smr(obs, pop, refdf$refcount, refdf$refpop, type="full", confidence=99.8, refvalue=100)
x <- covr::package_coverage()
covr::zero_coverage(x)
packageVersion("PHEindicatormethods")
x
devtools::check()
library(PHEindicatormethods)
?phe_dsr
library(dplyr)
df <- data.frame(indicatorid = rep(c(1234, 5678, 91011, 121314), each = 19 * 2 * 5),
year = rep(2006:2010, each = 19 * 2),
sex = rep(rep(c("Male", "Female"), each = 19), 5),
ageband = rep(c(0,5,10,15,20,25,30,35,40,45,
50,55,60,65,70,75,80,85,90), times = 10),
obs = sample(200, 19 * 2 * 5 * 4, replace = TRUE),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE))
df %>%
group_by(indicatorid, year, sex) %>%
phe_dsr(obs, pop)
devtools::check()
library(PHEindicatormethods)
?phe_dsr
library(dplyr)
df <- data.frame(indicatorid = rep(c(1234, 5678, 91011, 121314), each = 19 * 2 * 5),
year = rep(2006:2010, each = 19 * 2),
sex = rep(rep(c("Male", "Female"), each = 19), 5),
ageband = rep(c(0,5,10,15,20,25,30,35,40,45,
50,55,60,65,70,75,80,85,90), times = 10),
obs = sample(200, 19 * 2 * 5 * 4, replace = TRUE),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE))
df %>%
group_by(indicatorid, year, sex) %>%
phe_dsr(obs, pop)
remove.packages("PHEindicatormethods")
devtools::install_git("https://gitlab.phe.gov.uk/Georgina.Anderson/PHEindicatormethods", build_vignettes=TRUE)
?phe_mean
library(PHEindicatormethods)
?phe_mean
library(dplyr)
df <- data.frame(indicatorid = rep(c(1234, 5678, 91011, 121314), each = 19 * 2 * 5),
year = rep(2006:2010, each = 19 * 2),
sex = rep(rep(c("Male", "Female"), each = 19), 5),
ageband = rep(c(0,5,10,15,20,25,30,35,40,45,
50,55,60,65,70,75,80,85,90), times = 10),
obs = sample(200, 19 * 2 * 5 * 4, replace = TRUE),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE))
df %>%
group_by(indicatorid, year, sex) %>%
phe_dsr(obs, pop)
library(PHEindicatormethods)
?phe_rate
df <- data.frame(area = rep(c("Area1","Area2","Area3","Area4"), 2),
year = rep(2015:2016, each = 4),
obs = sample(100, 2 * 4, replace = TRUE),
pop = sample(100:200, 2 * 4, replace = TRUE))
df
phe_rate(df,obs,pop)
df %>%
group_by(area)
library(dplyr)
group_by(area)
df %>%
group_by(area)
df2 <- df %>%
group_by(area)
df2
phe_rate(df2,obs,pop)
remove.packages("tibble")
remove.packages("PHEindicatormethods")
remove.packages("dplyr")
devtools::install_git("https://gitlab.phe.gov.uk/Georgina.Anderson/PHEindicatormethods", build_vignettes=TRUE)
df <- data.frame(var1 = c(1,2,3), var2 = c("one","two","three"))
df %>%
select(var1)
df <- data.frame(area = rep(c("Area1","Area2","Area3","Area4"), 2),
year = rep(2015:2016, each = 4),
obs = sample(100, 2 * 4, replace = TRUE),
pop = sample(100:200, 2 * 4, replace = TRUE))
phe_rate(df, obs, pop)
library(PHEindicatormethods)
df %>%
select(var1)
df <- data.frame(area = rep(c("Area1","Area2","Area3","Area4"), 2),
year = rep(2015:2016, each = 4),
obs = sample(100, 2 * 4, replace = TRUE),
pop = sample(100:200, 2 * 4, replace = TRUE))
phe_rate(df, obs, pop)
remove.packages("tibble","dplyr","PHEindicatormethods")
?remove.packages
remove.packages(c("tibble","dplyr","PHEindicatormethods"))
devtools::install_git("https://gitlab.phe.gov.uk/Georgina.Anderson/PHEindicatormethods", build_vignettes=TRUE)
library(PHEindicatormethods)
?phe_dsr
knitr::opts_chunk$set(
collapse = TRUE,
error = TRUE,
comment = "#>"
)
pops <- data.frame(Period = rep(2013:2016, each = 19 * 3),
Region = rep(rep(c("Area1","Area2","Area3"),each=19),each=4),
AgeBand = rep(c(0,5,10,15,20,25,30,35,40,45,50,
55,60,65,70,75,80,85,90),times = 10),
pop = sample(10000:20000, 19 * 3 * 4, replace = TRUE)) %>%
arrange(Period, Region, AgeBand)
library(PHEindicatormethods)
library(dplyr)
pops <- data.frame(Period = rep(2013:2016, each = 19 * 3),
Region = rep(rep(c("Area1","Area2","Area3"),each=19),each=4),
AgeBand = rep(c(0,5,10,15,20,25,30,35,40,45,50,
55,60,65,70,75,80,85,90),times = 10),
pop = sample(10000:20000, 19 * 3 * 4, replace = TRUE)) %>%
arrange(Period, Region, AgeBand)
pops <- data.frame(Indicator = rep(c("Ind1","Ind2"), each = 19 * 3 * 4),
Period = rep(2013:2016, each = 19 * 3),
Region = rep(rep(c("Area1","Area2","Area3"),each=19), times = 4),
AgeBand = rep(c(0,5,10,15,20,25,30,35,40,45,50,
55,60,65,70,75,80,85,90),times = 3*4),
pop = sample(10000:20000, 19 * 2 * 3 * 4, replace = TRUE)) %>%
arrange(Period, Region, AgeBand)
View(pops)
pops <- data.frame(Indicator = rep(c("Ind1","Ind2"), times = 19 * 3 * 4),
Period = rep(2013:2016, each = 19 * 3),
Region = rep(rep(c("Area1","Area2","Area3"),each=19), times = 4),
AgeBand = rep(c(0,5,10,15,20,25,30,35,40,45,50,
55,60,65,70,75,80,85,90),times = 3*4),
pop = sample(10000:20000, 19 * 2 * 3 * 4, replace = TRUE)) %>%
arrange(Period, Region, AgeBand)
pops <- data.frame(Indicator = rep(c("Ind1","Ind2"), each = 19 * 3 * 4),
Period = rep(2013:2016, each = 19 * 3),
Region = rep(rep(c("Area1","Area2","Area3"),each=19), times = 4),
AgeBand = rep(c(0,5,10,15,20,25,30,35,40,45,50,
55,60,65,70,75,80,85,90),times = 3*4),
pop = sample(10000:20000, 19 * 2 * 3 * 4, replace = TRUE)) %>%
arrange(Period, Region, AgeBand)
?rep
?phe_dsr
rep(c("Ind1","Ind2"), each = 19 * 3 * 4)
rep(c("Ind1","Ind2"), each = 228)
df2 <- data.frame(indicatorid = rep(c(1234, 5678, 91011, 121314), each = 19 * 2 * 5),
year = rep(2006:2010, each = 19 * 2),
sex = rep(rep(c("Male", "Female"), each = 19), 5),
ageband = rep(c(0,5,10,15,20,25,30,35,40,45,
50,55,60,65,70,75,80,85,90), times = 10),
obs = sample(200, 19 * 2 * 5 * 4, replace = TRUE),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE))
View(df2)
pops <- data.frame(Indicator = rep(c("Ind1","Ind2","Ind3","Ind4"), each = 19 * 2 * 5),
Period = rep(2012:2016, each = 19 * 2),
Region = rep(rep(c("Area1","Area2"),each=19), times = 5),
AgeBand = rep(c(0,5,10,15,20,25,30,35,40,45,50,
55,60,65,70,75,80,85,90),times = 10),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE)) %>%
arrange(Period, Region, AgeBand)
View(pops)
pops <- data.frame(Indicator = rep(c("Ind1","Ind2","Ind3","Ind4"), each = 19 * 2 * 5),
Period = rep(2012:2016, each = 19 * 2),
Region = rep(rep(c("Area1","Area2"),each=19), times = 5),
AgeBand = rep(c(0,5,10,15,20,25,30,35,40,45,50,
55,60,65,70,75,80,85,90),times = 10),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE))
View(pops)
rm(df2)
dths <- data.frame(Indicator = rep(c("Ind1","Ind2","Ind3","Ind4"), each = 19 * 2 * 5),
Period = rep(2012:2016, each = 19 * 2),
Region = rep(rep(c("Area1","Area2"),each=19), times = 5),
AgeBand = rep(c(0,5,10,15,20,25,30,35,40,45,50,
55,60,65,70,75,80,85,90),times = 10),
obs = sample(200, 19 * 2 * 5 * 4, replace=TRUE))
df <- left_join(pops,deaths, by = c("Indicator","Period","Region","AgeBand")) %>%
group_by(Indicator, Period, Region)
deaths <- data.frame(Indicator = rep(c("Ind1","Ind2","Ind3","Ind4"), each = 19 * 2 * 5),
Period = rep(2012:2016, each = 19 * 2),
Region = rep(rep(c("Area1","Area2"),each=19), times = 5),
AgeBand = rep(c(0,5,10,15,20,25,30,35,40,45,50,
55,60,65,70,75,80,85,90),times = 10),
obs = sample(200, 19 * 2 * 5 * 4, replace=TRUE))
df <- left_join(pops,deaths, by = c("Indicator","Period","Region","AgeBand")) %>%
group_by(Indicator, Period, Region)
View(df)
summarise(df,n=n())
n_distinct(select(ungroup(summarise(df,n=n())),n)) == 1
length(esp2013)
pull(slice(select(ungroup(summarise(df,n=n())),n),1)) == length(esp2013)
all(df$AgeBand == rep(c(0,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90)))
pops <- data.frame(indicator = rep(c("Ind1","Ind2","Ind3","Ind4"), each = 19 * 2 * 5),
period = rep(2012:2016, each = 19 * 2),
region = rep(rep(c("Area1","Area2"),each=19), times = 5),
ageband = rep(c(0,5,10,15,20,25,30,35,40,45,50,
55,60,65,70,75,80,85,90),times = 10),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE))
deaths <- data.frame(indicator = rep(c("Ind1","Ind2","Ind3","Ind4"), each = 19 * 2 * 5),
period = rep(2012:2016, each = 19 * 2),
region = rep(rep(c("Area1","Area2"),each=19), times = 5),
ageband = rep(c(0,5,10,15,20,25,30,35,40,45,50,
55,60,65,70,75,80,85,90),times = 10),
dths = sample(200, 19 * 2 * 5 * 4, replace=TRUE))
rm(dths)
df <- left_join(pops,deaths, by = c("indicator","period","region","ageband")) %>%
group_by(indicator, period, region)
phe_dsr(df, dths, pops)
View(df)
groups(df)
phe_dsr(df, dths, pop)
phe_dsr(df, dths, pop)
phe_dsr(df, dths, pop, type = "full", confidence = 99.8, multiplier = 10000)
esp1976 <- c(8000,	7000,	7000,	7000,	7000,	7000,	7000,	7000,	7000,	7000,	7000,	6000,	5000,	4000,	3000,	2000,	1000,	1000)
df18 <- df
df18$Dths[df18$AgeBand == 85]       <- df18$Dths[df18$AgeBand == 85] + df18$Dths[df18$AgeBand == 90]
df18$Population[df18$AgeBand == 85] <- df18$Population[df18$AgeBand == 85] + df18$Population[df18$AgeBand == 90]
df18 <- filter(df18,AgeBand != 90)
phe_dsr(df18,Dths,Population,stdpop = esp1976)
esp1976 <- c(8000,	7000,	7000,	7000,	7000,	7000,	7000,	7000,	7000,	7000,	7000,	6000,	5000,	4000,	3000,	2000,	1000,	1000)
df18 <- df
df18$dths[df18$ageband == 85] <- df18$dths[df18$ageband == 85] + df18$dths[df18$ageband == 90]
df18$pop[df18$ageband == 85]  <- df18$pop[df18$ageband == 85] + df18$pop[df18$ageband == 90]
df18 <- filter(df18,ageband != 90)
phe_dsr(df18,dths,pop,stdpop = esp1976)
df_with_stdpop <- df %>%
mutate(spop = esp2013)
names(df_with_stdpop)
View(df_with_stdpop)
phe_dsr(df_with_stdpop, Dths, Population, stdpop = spop, stdpoptype = "field")
phe_dsr(df_with_stdpop, dths, pop, stdpop = spop, stdpoptype = "field")
pops2   <- data.frame(AgeBand    = c( 0, 5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90),
Population = c(30,35,35,35,40,40,45,50,50,50,60,60,70,75,70,60,20,20,15))
deaths2 <- data.frame(AgeBand = c(0,5,25,30,35,40,45,50,55,60,65,70,75,80,85,90),
Dths    = c(1,1, 1, 1, 3, 3, 3, 3,10,10,10,10, 8, 8, 8, 8))
df2 <- left_join(pops2, deaths2, by="AgeBand")
phe_dsr(df2, Dths, Population)
df2 <- left_join(pops2, deaths2, by="AgeBand")
phe_dsr(df2, dths, pop)
pops2   <- data.frame(ageband    = c( 0, 5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90),
pop = c(30,35,35,35,40,40,45,50,50,50,60,60,70,75,70,60,20,20,15))
deaths2 <- data.frame(ageband = c(0,5,25,30,35,40,45,50,55,60,65,70,75,80,85,90),
dths    = c(1,1, 1, 1, 3, 3, 3, 3,10,10,10,10, 8, 8, 8, 8))
df2 <- left_join(pops2, deaths2, by="AgeBand")
phe_dsr(df2, dths, pop)
df2 <- left_join(pops2, deaths2, by="ageband")
phe_dsr(df2, dths, pop)
df3 <- df2 %>%
mutate(dths = replace(dths, which(is.na(dths)), 0))
phe_dsr(df3, dths, pop)
head(deaths)
right <- phe_dsr(df,dths,pop)
wrong <- df %>%
arrange(desc(ageband)) %>%
phe_dsr(dths,pop)
identical(right,wrong)
right2 <- phe_dsr(df,dths,pop)
identical(right,right2)
library(PHEindicatormethods)
devtools::document()
library(PHEindicatormethods)
?phe_rate
devtools::document()
devtools::check()
install.packages("qpdf")
devtools::document()
devtools::document()
library(PHEindicatormethods)
?phe_rate
devtools::document()
devtools::load_all()
library(PHEindicatormethods)
devtools::check()
Sys.which("qpdf")
Sys.which("qpdf")
devtools::use_data(test_BW, test_Prop,
test_Rate,
test_Mean, test_Mean_Grp, test_Mean_results,
test_multiarea, test_multigroup, test_DSR_1976, test_err1, test_err2, test_err3, test_DSR_results,
test_ISR_refdata, test_ISR_results, test_ISR_ownref,
internal = TRUE, overwrite = TRUE)
test_BW <- read_excel(".\\tests\\testthat\\testdata_Byars_Wilson.xlsx", sheet="testdata_B_W",   col_names=TRUE)
# Proportions
test_Prop   <- read_excel(".\\tests\\testthat\\testdata_Proportion.xlsx", sheet="testdata_Prop",   col_names=TRUE)
#Rates
test_Rate <- read_excel(".\\tests\\testthat\\testdata_Rate.xlsx", sheet="testdata_Rate", col_names=TRUE)
#Means
test_Mean         <- read_excel(".\\tests\\testthat\\testdata_Mean.xlsx", sheet="testdata_Mean",         col_names=TRUE)
test_Mean_results <- read_excel(".\\tests\\testthat\\testdata_Mean.xlsx", sheet="testdata_Mean_results", col_names=TRUE)
test_Mean_Grp <- group_by(test_Mean,area)
# DSRs, ISRs and SMRs
test_multiarea   <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multiarea", col_names=TRUE) %>%
group_by(area)
test_DSR_1976    <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_1976",   col_names=TRUE)
test_err1        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err1",   col_names=TRUE)
test_err2        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err2",   col_names=TRUE) %>%
group_by(area)
test_err3        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err3",   col_names=TRUE)
test_DSR_results <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testresults_DSR", col_names=TRUE)
test_multigroup  <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multigroup", col_names=TRUE) %>%
group_by(area,year)
test_ISR_results <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testresults_ISR", col_names=TRUE)
test_ISR_refdata <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="refdata",         col_names=TRUE)
test_ISR_ownref  <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multiarea_ref", col_names=TRUE) %>%
group_by(area)
library(dplyr)
library(readxl)
test_BW <- read_excel(".\\tests\\testthat\\testdata_Byars_Wilson.xlsx", sheet="testdata_B_W",   col_names=TRUE)
# Proportions
test_Prop   <- read_excel(".\\tests\\testthat\\testdata_Proportion.xlsx", sheet="testdata_Prop",   col_names=TRUE)
#Rates
test_Rate <- read_excel(".\\tests\\testthat\\testdata_Rate.xlsx", sheet="testdata_Rate", col_names=TRUE)
#Means
test_Mean         <- read_excel(".\\tests\\testthat\\testdata_Mean.xlsx", sheet="testdata_Mean",         col_names=TRUE)
test_Mean_results <- read_excel(".\\tests\\testthat\\testdata_Mean.xlsx", sheet="testdata_Mean_results", col_names=TRUE)
test_Mean_Grp <- group_by(test_Mean,area)
# DSRs, ISRs and SMRs
test_multiarea   <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multiarea", col_names=TRUE) %>%
group_by(area)
test_DSR_1976    <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_1976",   col_names=TRUE)
test_err1        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err1",   col_names=TRUE)
test_err2        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err2",   col_names=TRUE) %>%
group_by(area)
test_err3        <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_err3",   col_names=TRUE)
test_DSR_results <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testresults_DSR", col_names=TRUE)
test_multigroup  <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multigroup", col_names=TRUE) %>%
group_by(area,year)
test_ISR_results <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testresults_ISR", col_names=TRUE)
test_ISR_refdata <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="refdata",         col_names=TRUE)
test_ISR_ownref  <- read_excel(".\\tests\\testthat\\testdata_DSR_ISR_SMR.xlsx", sheet="testdata_multiarea_ref", col_names=TRUE) %>%
group_by(area)
# use this code to save loaded data to R\sysdata.rda file:
devtools::use_data(test_BW, test_Prop,
test_Rate,
test_Mean, test_Mean_Grp, test_Mean_results,
test_multiarea, test_multigroup, test_DSR_1976, test_err1, test_err2, test_err3, test_DSR_results,
test_ISR_refdata, test_ISR_results, test_ISR_ownref,
internal = TRUE, overwrite = TRUE)
options(scipen=999)
library(PHEindicatormethods)
?phe_mean
library(dplyr)
df <- data.frame(values = c(30,40,50,60))
phe_mean(df, values)
df <- phe_mean(df,values)
df
?phe_proportion
df <- data.frame(area = c("Area1","Area2","Area3"),
numerator = c(65,82,100),
denominator = c(100,100,100))
phe_proportion(df, numerator, denominator)
df <- data.frame(area = c("Area1","Area2","Area3"),
numerator = c(65,82,100),
denominator = c(100,100,100))
check <- phe_proportion(df, numerator, denominator)
?phe_dsr
library(dplyr)
df <- data.frame(indicatorid = rep(c(1234, 5678, 91011, 121314), each = 19 * 2 * 5),
year = rep(2006:2010, each = 19 * 2),
sex = rep(rep(c("Male", "Female"), each = 19), 5),
ageband = rep(c(0,5,10,15,20,25,30,35,40,45,
50,55,60,65,70,75,80,85,90), times = 10),
obs = sample(200, 19 * 2 * 5 * 4, replace = TRUE),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE))
df %>%
group_by(indicatorid, year, sex)
check <- phe_dsr(df,obs,pop)
library(dplyr)
df <- data.frame(indicatorid = rep(c(1234, 5678, 91011, 121314), each = 19 * 2 * 5),
year = rep(2006:2010, each = 19 * 2),
sex = rep(rep(c("Male", "Female"), each = 19), 5),
ageband = rep(c(0,5,10,15,20,25,30,35,40,45,
50,55,60,65,70,75,80,85,90), times = 10),
obs = sample(200, 19 * 2 * 5 * 4, replace = TRUE),
pop = sample(10000:20000, 19 * 2 * 5 * 4, replace = TRUE))
df %>%
group_by(indicatorid, year, sex) %>%
phe_dsr(obs, pop)
df <- df %>%
group_by(indicatorid,year,sex)
phe_dsr(df,obs,pop)
devtools::document()
library(epitools)
?binom.conf.int
View(binom.conf.int)
??binom.conf.int
View(binom.wilson)
library(PHEindicatormethods)
devtools::check()
